!function(a,b){"function"==typeof define&&define.amd&&define([],b),"object"==typeof a.navigator&&("undefined"==typeof a.Terraformer&&(a.Terraformer={}),"undefined"==typeof a.Terraformer.Store&&(a.Terraformer.Store={}),a.Terraformer.Store.LocalStorage=b().LocalStorage)}(this,function(){function a(){var a=arguments[0]||{};this._key=a.key||"_terraformer"}var b,c={};return"object"==typeof this.navigator&&(b=this.Terraformer),"object"==typeof module&&"object"==typeof module.exports&&(b=require("terraformer")),arguments[0]&&"function"==typeof define&&define.amd&&(b=arguments[0]),a.prototype.add=function(a,b){if("FeatureCollection"===a.type)for(var c=0;c<a.features.length;c++)this.set(a.features[c]);else this.set(a);return b.resolve(a),b},a.prototype.key=function(a){return this._key+"_"+a},a.prototype.remove=function(a,b){return localStorage.removeItem(this.key(a)),b.resolve(),b},a.prototype.get=function(a,b){return b.resolve(JSON.parse(localStorage.getItem(this.key(a)))),b},a.prototype.set=function(a){localStorage.setItem(this.key(a.id),JSON.stringify(a))},a.prototype.update=function(a,b){return this.set(a),b.resolve(a),b},a.prototype.toJSON=function(){var a={};for(var b in localStorage)b.match(this._key)&&(a[b]=localStorage[b]);return a},a.prototype.serialize=function(a){var c=[],d=new b.Deferred;a&&d.then(function(b){a(null,b)},function(b){a(b,null)});for(var e in localStorage)e.match(this._key)&&c.push(localStorage.getItem(e));return d.resolve(JSON.stringify(c)),d},a.prototype.deserialize=function(a){for(var b=JSON.parse(a),c=b.length-1;c>=0;c--)this.set(b[c]);return this},c.LocalStorage=a,c});